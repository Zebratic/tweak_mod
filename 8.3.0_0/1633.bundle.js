(self.webpackChunktweak=self.webpackChunktweak||[]).push([[1633],{1633:(e,t,i)=>{i.r(t),i.d(t,{CommonFindController:()=>at,FindController:()=>ht,MatchFindAction:()=>gt,NextMatchFindAction:()=>pt,NextSelectionMatchFindAction:()=>vt,PreviousMatchFindAction:()=>_t,PreviousSelectionMatchFindAction:()=>ft,SelectionMatchFindAction:()=>mt,StartFindAction:()=>dt,StartFindReplaceAction:()=>St,StartFindWithArgsAction:()=>lt,StartFindWithSelectionAction:()=>ut,getSelectionSearchString:()=>rt});var s=i(5393),o=i(9917),n=i(7295),r=i(6830),a=i(9102),h=i(9488),d=i(1329),c=i(187),l=i(4314),u=i(3860),g=i(7277),p=i(4973),_=i(2035),m=i(3910),v=i(7781);class f{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.removeDecorations(this._allDecorations()),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map((e=>this._editor.getModel().getDecorationRange(e))).filter((e=>!!e));if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getCurrentMatchesPosition(e){const t=this._editor.getModel().getDecorationsInRange(e);for(const e of t){const t=e.options;if(t===f._FIND_MATCH_DECORATION||t===f._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(e.id)}return 0}setCurrentFindMatch(e){let t=null,i=0;if(e)for(let s=0,o=this._decorations.length;s<o;s++){const o=this._editor.getModel().getDecorationRange(this._decorations[s]);if(e.equalsRange(o)){t=this._decorations[s],i=s+1;break}}return null===this._highlightedDecorationId&&null===t||this._editor.changeDecorations((e=>{if(null!==this._highlightedDecorationId&&(e.changeDecorationOptions(this._highlightedDecorationId,f._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),null!==t&&(this._highlightedDecorationId=t,e.changeDecorationOptions(this._highlightedDecorationId,f._CURRENT_FIND_MATCH_DECORATION)),null!==this._rangeHighlightDecorationId&&(e.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),null!==t){let i=this._editor.getModel().getDecorationRange(t);if(i.startLineNumber!==i.endLineNumber&&1===i.endColumn){const e=i.endLineNumber-1,t=this._editor.getModel().getLineMaxColumn(e);i=new l.e(i.startLineNumber,i.startColumn,e,t)}this._rangeHighlightDecorationId=e.addDecoration(i,f._RANGE_HIGHLIGHT_DECORATION)}})),i}set(e,t){this._editor.changeDecorations((i=>{let s=f._FIND_MATCH_DECORATION;const o=[];if(e.length>1e3){s=f._FIND_MATCH_NO_OVERVIEW_DECORATION;const t=this._editor.getModel().getLineCount(),i=this._editor.getLayoutInfo().height/t,n=Math.max(2,Math.ceil(3/i));let r=e[0].range.startLineNumber,a=e[0].range.endLineNumber;for(let t=1,i=e.length;t<i;t++){const i=e[t].range;a+n>=i.startLineNumber?i.endLineNumber>a&&(a=i.endLineNumber):(o.push({range:new l.e(r,1,a,1),options:f._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),r=i.startLineNumber,a=i.endLineNumber)}o.push({range:new l.e(r,1,a,1),options:f._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}const n=new Array(e.length);for(let t=0,i=e.length;t<i;t++)n[t]={range:e[t].range,options:s};this._decorations=i.deltaDecorations(this._decorations,n),this._overviewRulerApproximateDecorations=i.deltaDecorations(this._overviewRulerApproximateDecorations,o),this._rangeHighlightDecorationId&&(i.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach((e=>i.removeDecoration(e))),this._findScopeDecorationIds=[]),(null==t?void 0:t.length)&&(this._findScopeDecorationIds=t.map((e=>i.addDecoration(e,f._FIND_SCOPE_DECORATION))))}))}matchBeforePosition(e){if(0===this._decorations.length)return null;for(let t=this._decorations.length-1;t>=0;t--){const i=this._decorations[t],s=this._editor.getModel().getDecorationRange(i);if(s&&!(s.endLineNumber>e.lineNumber)){if(s.endLineNumber<e.lineNumber)return s;if(!(s.endColumn>e.column))return s}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(0===this._decorations.length)return null;for(let t=0,i=this._decorations.length;t<i;t++){const i=this._decorations[t],s=this._editor.getModel().getDecorationRange(i);if(s&&!(s.startLineNumber<e.lineNumber)){if(s.startLineNumber>e.lineNumber)return s;if(!(s.startColumn<e.column))return s}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}}f._CURRENT_FIND_MATCH_DECORATION=_.qx.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:(0,v.EN)(m.Fm_),position:p.sh.Center},minimap:{color:(0,v.EN)(m.SUY),position:p.F5.Inline}}),f._FIND_MATCH_DECORATION=_.qx.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:(0,v.EN)(m.Fm_),position:p.sh.Center},minimap:{color:(0,v.EN)(m.SUY),position:p.F5.Inline}}),f._FIND_MATCH_NO_OVERVIEW_DECORATION=_.qx.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0}),f._FIND_MATCH_ONLY_OVERVIEW_DECORATION=_.qx.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:(0,v.EN)(m.Fm_),position:p.sh.Center}}),f._RANGE_HIGHLIGHT_DECORATION=_.qx.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0}),f._FIND_SCOPE_DECORATION=_.qx.register({description:"find-scope",className:"findScope",isWholeLine:!0});class S{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){const e=[];for(let t=0;t<this._ranges.length;t++)e.push({range:this._ranges[t],text:this._replaceStrings[t]});e.sort(((e,t)=>l.e.compareRangesUsingStarts(e.range,t.range)));const i=[];let s=e[0];for(let t=1;t<e.length;t++)s.range.endLineNumber===e[t].range.startLineNumber&&s.range.endColumn===e[t].range.startColumn?(s.range=s.range.plusRange(e[t].range),s.text=s.text+e[t].text):(i.push(s),s=e[t]);i.push(s);for(const e of i)t.addEditOperation(e.range,e.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}function C(e,t){if(e&&""!==e[0]){const i=b(e,t,"-"),s=b(e,t,"_");return i&&!s?w(e,t,"-"):!i&&s?w(e,t,"_"):e[0].toUpperCase()===e[0]?t.toUpperCase():e[0].toLowerCase()===e[0]?t.toLowerCase():n.Kw(e[0][0])&&t.length>0?t[0].toUpperCase()+t.substr(1):e[0][0].toUpperCase()!==e[0][0]&&t.length>0?t[0].toLowerCase()+t.substr(1):t}return t}function b(e,t,i){return-1!==e[0].indexOf(i)&&-1!==t.indexOf(i)&&e[0].split(i).length===t.split(i).length}function w(e,t,i){const s=t.split(i),o=e[0].split(i);let n="";return s.forEach(((e,t)=>{n+=C([o[t]],e)+i})),n.slice(0,-1)}class x{constructor(e){this.staticValue=e,this.kind=0}}class N{constructor(e){this.pieces=e,this.kind=1}}class R{constructor(e){e&&0!==e.length?1===e.length&&null!==e[0].staticValue?this._state=new x(e[0].staticValue):this._state=new N(e):this._state=new x("")}static fromStaticValue(e){return new R([y.staticValue(e)])}get hasReplacementPatterns(){return 1===this._state.kind}buildReplaceString(e,t){if(0===this._state.kind)return t?C(e,this._state.staticValue):this._state.staticValue;let i="";for(let t=0,s=this._state.pieces.length;t<s;t++){const s=this._state.pieces[t];if(null!==s.staticValue){i+=s.staticValue;continue}let o=R._substitute(s.matchIndex,e);if(null!==s.caseOps&&s.caseOps.length>0){const e=[],t=s.caseOps.length;let i=0;for(let n=0,r=o.length;n<r;n++){if(i>=t){e.push(o.slice(n));break}switch(s.caseOps[i]){case"U":e.push(o[n].toUpperCase());break;case"u":e.push(o[n].toUpperCase()),i++;break;case"L":e.push(o[n].toLowerCase());break;case"l":e.push(o[n].toLowerCase()),i++;break;default:e.push(o[n])}}o=e.join("")}i+=o}return i}static _substitute(e,t){if(null===t)return"";if(0===e)return t[0];let i="";for(;e>0;){if(e<t.length){return(t[e]||"")+i}i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class y{constructor(e,t,i){this.staticValue=e,this.matchIndex=t,i&&0!==i.length?this.caseOps=i.slice(0):this.caseOps=null}static staticValue(e){return new y(e,-1,null)}static caseOps(e,t){return new y(null,e,t)}}class I{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){0!==e.length&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,i){0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=y.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=y.caseOps(e,i),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=y.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new R(this._result)}}var F=i(8819);const O=new F.uy("findWidgetVisible",!1),E=(O.toNegated(),new F.uy("findInputFocussed",!1)),B=new F.uy("replaceInputFocussed",!1),k={primary:545,mac:{primary:2593}},A={primary:565,mac:{primary:2613}},D={primary:560,mac:{primary:2608}},M={primary:554,mac:{primary:2602}},V={primary:558,mac:{primary:2606}},W="actions.find",P="actions.findWithSelection",T="editor.actions.findWithArgs",L="editor.action.nextMatchFindAction",H="editor.action.previousMatchFindAction",q="editor.action.nextSelectionMatchFindAction",U="editor.action.previousSelectionMatchFindAction",K="editor.action.startFindReplaceAction",Z="closeFindWidget",$="toggleFindCaseSensitive",G="toggleFindWholeWord",z="toggleFindRegex",Q="toggleFindInSelection",Y="togglePreserveCase",j="editor.action.replaceOne",X="editor.action.replaceAll",J="editor.action.selectAllMatches",ee=19999;class te{constructor(e,t){this._toDispose=new o.SL,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new s._F,this._decorations=new f(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new s.pY((()=>this.research(!1)),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition((e=>{3!==e.reason&&5!==e.reason&&6!==e.reason||this._decorations.setStartPosition(this._editor.getPosition())}))),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent((e=>{this._ignoreModelContentChanged||(e.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())}))),this._toDispose.add(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,(0,o.B9)(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){if(!this._isDisposed&&this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)){this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet((()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}),240)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let i=null;void 0!==t?null!==t&&(i=Array.isArray(t)?t:[t]):i=this._decorations.getFindScopes(),null!==i&&(i=i.map((e=>{if(e.startLineNumber!==e.endLineNumber){let t=e.endLineNumber;return 1===e.endColumn&&(t-=1),new l.e(e.startLineNumber,1,t,this._editor.getModel().getLineMaxColumn(t))}return e})));const s=this._findMatches(i,!1,ee);this._decorations.set(s,i);const o=this._editor.getSelection();let n=this._decorations.getCurrentMatchesPosition(o);if(0===n&&s.length>0){const e=(0,h.lG)(s.map((e=>e.range)),(e=>l.e.compareRangesUsingStarts(e,o)>=0));n=e>0?e-1+1:n}this._state.changeMatchInfo(n,this._decorations.getCount(),void 0),e&&this._editor.getOption(37).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){const e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){const t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:s}=e;const o=this._editor.getModel();return t||1===s?(1===i?i=o.getLineCount():i--,s=o.getLineMaxColumn(i)):s--,new c.L(i,s)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const t=this._decorations.matchAfterPosition(e);return void(t&&this._setCurrentFindMatch(t))}if(this._decorations.getCount()<ee){let t=this._decorations.matchBeforePosition(e);return t&&t.isEmpty()&&t.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),t=this._decorations.matchBeforePosition(e)),void(t&&this._setCurrentFindMatch(t))}if(this._cannotFind())return;const i=this._decorations.getFindScope(),s=te._getSearchRange(this._editor.getModel(),i);s.getEndPosition().isBefore(e)&&(e=s.getEndPosition()),e.isBefore(s.getStartPosition())&&(e=s.getEndPosition());const{lineNumber:o,column:n}=e,r=this._editor.getModel();let a=new c.L(o,n),h=r.findPreviousMatch(this._state.searchString,a,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(119):null,!1);return h&&h.range.isEmpty()&&h.range.getStartPosition().equals(a)&&(a=this._prevSearchPosition(a),h=r.findPreviousMatch(this._state.searchString,a,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(119):null,!1)),h?t||s.containsRange(h.range)?void this._setCurrentFindMatch(h.range):this._moveToPrevMatch(h.range.getStartPosition(),!0):void 0}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:s}=e;const o=this._editor.getModel();return t||s===o.getLineMaxColumn(i)?(i===o.getLineCount()?i=1:i++,s=1):s++,new c.L(i,s)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const t=this._decorations.matchBeforePosition(e);return void(t&&this._setCurrentFindMatch(t))}if(this._decorations.getCount()<ee){let t=this._decorations.matchAfterPosition(e);return t&&t.isEmpty()&&t.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),t=this._decorations.matchAfterPosition(e)),void(t&&this._setCurrentFindMatch(t))}const t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,i,s=!1){if(this._cannotFind())return null;const o=this._decorations.getFindScope(),n=te._getSearchRange(this._editor.getModel(),o);n.getEndPosition().isBefore(e)&&(e=n.getStartPosition()),e.isBefore(n.getStartPosition())&&(e=n.getStartPosition());const{lineNumber:r,column:a}=e,h=this._editor.getModel();let d=new c.L(r,a),l=h.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(119):null,t);return i&&l&&l.range.isEmpty()&&l.range.getStartPosition().equals(d)&&(d=this._nextSearchPosition(d),l=h.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(119):null,t)),l?s||n.containsRange(l.range)?l:this._getNextMatch(l.range.getEndPosition(),t,i,!0):null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_getReplacePattern(){return this._state.isRegex?function(e){if(!e||0===e.length)return new R(null);const t=[],i=new I(e);for(let s=0,o=e.length;s<o;s++){const n=e.charCodeAt(s);if(92!==n){if(36===n){if(s++,s>=o)break;const n=e.charCodeAt(s);if(36===n){i.emitUnchanged(s-1),i.emitStatic("$",s+1);continue}if(48===n||38===n){i.emitUnchanged(s-1),i.emitMatchIndex(0,s+1,t),t.length=0;continue}if(49<=n&&n<=57){let r=n-48;if(s+1<o){const o=e.charCodeAt(s+1);if(48<=o&&o<=57){s++,r=10*r+(o-48),i.emitUnchanged(s-2),i.emitMatchIndex(r,s+1,t),t.length=0;continue}}i.emitUnchanged(s-1),i.emitMatchIndex(r,s+1,t),t.length=0;continue}}}else{if(s++,s>=o)break;const n=e.charCodeAt(s);switch(n){case 92:i.emitUnchanged(s-1),i.emitStatic("\\",s+1);break;case 110:i.emitUnchanged(s-1),i.emitStatic("\n",s+1);break;case 116:i.emitUnchanged(s-1),i.emitStatic("\t",s+1);break;case 117:case 85:case 108:case 76:i.emitUnchanged(s-1),i.emitStatic("",s+1),t.push(String.fromCharCode(n))}}}return i.finalize()}(this._state.replaceString):R.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;const e=this._getReplacePattern(),t=this._editor.getSelection(),i=this._getNextMatch(t.getStartPosition(),!0,!1);if(i)if(t.equalsRange(i.range)){const s=e.buildReplaceString(i.matches,this._state.preserveCase),o=new d.T4(t,s);this._executeEditorCommand("replace",o),this._decorations.setStartPosition(new c.L(t.startLineNumber,t.startColumn+s.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(i.range)}_findMatches(e,t,i){const s=(e||[null]).map((e=>te._getSearchRange(this._editor.getModel(),e)));return this._editor.getModel().findMatches(this._state.searchString,s,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(119):null,t,i)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();null===e&&this._state.matchesCount>=ee?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const e=new g.bc(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(119):null).parseSearchRequest();if(!e)return;let t=e.regex;if(!t.multiline){let e="mu";t.ignoreCase&&(e+="i"),t.global&&(e+="g"),t=new RegExp(t.source,e)}const i=this._editor.getModel(),s=i.getValue(1),o=i.getFullModelRange(),n=this._getReplacePattern();let r;const a=this._state.preserveCase;r=n.hasReplacementPatterns||a?s.replace(t,(function(){return n.buildReplaceString(arguments,a)})):s.replace(t,n.buildReplaceString(null,a));const h=new d.hP(o,r,this._editor.getSelection());this._executeEditorCommand("replaceAll",h)}_regularReplaceAll(e){const t=this._getReplacePattern(),i=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),s=[];for(let e=0,o=i.length;e<o;e++)s[e]=t.buildReplaceString(i[e].matches,this._state.preserveCase);const o=new S(this._editor.getSelection(),i.map((e=>e.range)),s);this._executeEditorCommand("replaceAll",o)}selectAllMatches(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();let t=this._findMatches(e,!1,1073741824).map((e=>new u.Y(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn)));const i=this._editor.getSelection();for(let e=0,s=t.length;e<s;e++){if(t[e].equalsRange(i)){t=[i].concat(t.slice(0,e)).concat(t.slice(e+1));break}}this._editor.setSelections(t)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}var ie=i(5321),se=i(1307),oe=i(3794);class ne extends oe.${constructor(e,t,i,o){super(),this._hideSoon=this._register(new s.pY((()=>this._hide()),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const n=o.getColorTheme().getColor(m.PRb),r=o.getColorTheme().getColor(m.Pvw),a=o.getColorTheme().getColor(m.XEs);this.caseSensitive=this._register(new se.rk({appendTitle:this._keybindingLabelFor($),isChecked:this._state.matchCase,inputActiveOptionBorder:n,inputActiveOptionForeground:r,inputActiveOptionBackground:a})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange((()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)}))),this.wholeWords=this._register(new se.Qx({appendTitle:this._keybindingLabelFor(G),isChecked:this._state.wholeWord,inputActiveOptionBorder:n,inputActiveOptionForeground:r,inputActiveOptionBackground:a})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange((()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)}))),this.regex=this._register(new se.eH({appendTitle:this._keybindingLabelFor(z),isChecked:this._state.isRegex,inputActiveOptionBorder:n,inputActiveOptionForeground:r,inputActiveOptionBackground:a})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange((()=>{this._state.change({isRegex:this.regex.checked},!1)}))),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange((e=>{let t=!1;e.isRegex&&(this.regex.checked=this._state.isRegex,t=!0),e.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,t=!0),e.matchCase&&(this.caseSensitive.checked=this._state.matchCase,t=!0),!this._state.isRevealed&&t&&this._revealTemporarily()}))),this._register(ie.nm(this._domNode,ie.tw.MOUSE_LEAVE,(e=>this._onMouseLeave()))),this._register(ie.nm(this._domNode,"mouseover",(e=>this._onMouseOver()))),this._applyTheme(o.getColorTheme()),this._register(o.onDidColorThemeChange(this._applyTheme.bind(this)))}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return ne.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseLeave(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}_applyTheme(e){const t={inputActiveOptionBorder:e.getColor(m.PRb),inputActiveOptionForeground:e.getColor(m.Pvw),inputActiveOptionBackground:e.getColor(m.XEs)};this.caseSensitive.style(t),this.wholeWords.style(t),this.regex.style(t)}}ne.ID="editor.contrib.findOptionsWidget",(0,v.Ic)(((e,t)=>{const i=e.getColor(m.D0T);i&&t.addRule(`.monaco-editor .findOptionsWidget { background-color: ${i}; }`);const s=e.getColor(m.Hfx);s&&t.addRule(`.monaco-editor .findOptionsWidget { color: ${s}; }`);const o=e.getColor(m.rh);o&&t.addRule(`.monaco-editor .findOptionsWidget { box-shadow: 0 0 8px 2px ${o}; }`);const n=e.getColor(m.lRK);n&&t.addRule(`.monaco-editor .findOptionsWidget { border: 2px solid ${n}; }`)}));var re=i(4669);function ae(e,t){return 1===e||2!==e&&t}class he extends o.JT{constructor(){super(),this._onFindReplaceStateChange=this._register(new re.Q5),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return ae(this._isRegexOverride,this._isRegex)}get wholeWord(){return ae(this._wholeWordOverride,this._wholeWord)}get matchCase(){return ae(this._matchCaseOverride,this._matchCase)}get preserveCase(){return ae(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}changeMatchInfo(e,t,i){const s={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let o=!1;0===t&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,s.matchesPosition=!0,o=!0),this._matchesCount!==t&&(this._matchesCount=t,s.matchesCount=!0,o=!0),void 0!==i&&(l.e.equalsRange(this._currentMatch,i)||(this._currentMatch=i,s.currentMatch=!0,o=!0)),o&&this._onFindReplaceStateChange.fire(s)}change(e,t,i=!0){var s;const o={moveCursor:t,updateHistory:i,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let n=!1;const r=this.isRegex,a=this.wholeWord,h=this.matchCase,d=this.preserveCase;void 0!==e.searchString&&this._searchString!==e.searchString&&(this._searchString=e.searchString,o.searchString=!0,n=!0),void 0!==e.replaceString&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,o.replaceString=!0,n=!0),void 0!==e.isRevealed&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,o.isRevealed=!0,n=!0),void 0!==e.isReplaceRevealed&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,o.isReplaceRevealed=!0,n=!0),void 0!==e.isRegex&&(this._isRegex=e.isRegex),void 0!==e.wholeWord&&(this._wholeWord=e.wholeWord),void 0!==e.matchCase&&(this._matchCase=e.matchCase),void 0!==e.preserveCase&&(this._preserveCase=e.preserveCase),void 0!==e.searchScope&&((null===(s=e.searchScope)||void 0===s?void 0:s.every((e=>{var t;return null===(t=this._searchScope)||void 0===t?void 0:t.some((t=>!l.e.equalsRange(t,e)))})))||(this._searchScope=e.searchScope,o.searchScope=!0,n=!0)),void 0!==e.loop&&this._loop!==e.loop&&(this._loop=e.loop,o.loop=!0,n=!0),void 0!==e.isSearching&&this._isSearching!==e.isSearching&&(this._isSearching=e.isSearching,o.isSearching=!0,n=!0),void 0!==e.filters&&(this._filters?this._filters.update(e.filters):this._filters=e.filters,o.filters=!0,n=!0),this._isRegexOverride=void 0!==e.isRegexOverride?e.isRegexOverride:0,this._wholeWordOverride=void 0!==e.wholeWordOverride?e.wholeWordOverride:0,this._matchCaseOverride=void 0!==e.matchCaseOverride?e.matchCaseOverride:0,this._preserveCaseOverride=void 0!==e.preserveCaseOverride?e.preserveCaseOverride:0,r!==this.isRegex&&(n=!0,o.isRegex=!0),a!==this.wholeWord&&(n=!0,o.wholeWord=!0),h!==this.matchCase&&(n=!0,o.matchCase=!0),d!==this.preserveCase&&(n=!0,o.preserveCase=!0),n&&this._onFindReplaceStateChange.fire(o)}canNavigateBack(){return this.canNavigateInLoop()||1!==this.matchesPosition}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=ee}}var de=i(5152),ce=i(2900),le=i(3098),ue=i(3046),ge=i(7301),pe=i(1432),_e=i(3580),me=i(2980);function ve(e){var t,i;return"Up"===(null===(t=e.lookupKeybinding("history.showPrevious"))||void 0===t?void 0:t.getElectronAccelerator())&&"Down"===(null===(i=e.lookupKeybinding("history.showNext"))||void 0===i?void 0:i.getElectronAccelerator())}var fe=i(9554),Se=i(2321),Ce=function(e,t,i,s){return new(i||(i=Promise))((function(o,n){function r(e){try{h(s.next(e))}catch(e){n(e)}}function a(e){try{h(s.throw(e))}catch(e){n(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}h((s=s.apply(e,t||[])).next())}))};const be=(0,fe.q5)("find-selection",ue.lA.selection,_e.NC("findSelectionIcon","Icon for 'Find in Selection' in the editor find widget.")),we=(0,fe.q5)("find-collapsed",ue.lA.chevronRight,_e.NC("findCollapsedIcon","Icon to indicate that the editor find widget is collapsed.")),xe=(0,fe.q5)("find-expanded",ue.lA.chevronDown,_e.NC("findExpandedIcon","Icon to indicate that the editor find widget is expanded.")),Ne=(0,fe.q5)("find-replace",ue.lA.replace,_e.NC("findReplaceIcon","Icon for 'Replace' in the editor find widget.")),Re=(0,fe.q5)("find-replace-all",ue.lA.replaceAll,_e.NC("findReplaceAllIcon","Icon for 'Replace All' in the editor find widget.")),ye=(0,fe.q5)("find-previous-match",ue.lA.arrowUp,_e.NC("findPreviousMatchIcon","Icon for 'Find Previous' in the editor find widget.")),Ie=(0,fe.q5)("find-next-match",ue.lA.arrowDown,_e.NC("findNextMatchIcon","Icon for 'Find Next' in the editor find widget.")),Fe=_e.NC("label.find","Find"),Oe=_e.NC("placeholder.find","Find"),Ee=_e.NC("label.previousMatchButton","Previous Match"),Be=_e.NC("label.nextMatchButton","Next Match"),ke=_e.NC("label.toggleSelectionFind","Find in Selection"),Ae=_e.NC("label.closeButton","Close"),De=_e.NC("label.replace","Replace"),Me=_e.NC("placeholder.replace","Replace"),Ve=_e.NC("label.replaceButton","Replace"),We=_e.NC("label.replaceAllButton","Replace All"),Pe=_e.NC("label.toggleReplaceButton","Toggle Replace"),Te=_e.NC("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",ee),Le=_e.NC("label.matchesLocation","{0} of {1}"),He=_e.NC("label.noResults","No results"),qe=419;let Ue=69;const Ke="ctrlEnterReplaceAll.windows.donotask",Ze=pe.dz?256:2048;class $e{constructor(e){this.afterLineNumber=e,this.heightInPx=33,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function Ge(e,t,i){const s=!!t.match(/\n/);i&&s&&i.selectionStart>0&&e.stopPropagation()}function ze(e,t,i){const s=!!t.match(/\n/);i&&s&&i.selectionEnd<i.value.length&&e.stopPropagation()}class Qe extends oe.${constructor(e,t,i,n,r,a,h,d,c){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=i,this._contextViewProvider=n,this._keybindingService=r,this._contextKeyService=a,this._storageService=d,this._notificationService=c,this._ctrlEnterReplaceAllWarningPrompted=!!d.getBoolean(Ke,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new s.vp(500),this._register((0,o.OF)((()=>this._updateHistoryDelayer.cancel()))),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration((e=>{if(e.hasChanged(83)&&(this._codeEditor.getOption(83)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),e.hasChanged(133)&&this._tryUpdateWidgetWidth(),e.hasChanged(2)&&this.updateAccessibilitySupport(),e.hasChanged(37)){const e=this._codeEditor.getOption(37).addExtraSpaceOnTop;e&&!this._viewZone&&(this._viewZone=new $e(0),this._showViewZone()),!e&&this._viewZone&&this._removeViewZone()}}))),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection((()=>{this._isVisible&&this._updateToggleSelectionFindButton()}))),this._register(this._codeEditor.onDidFocusEditorWidget((()=>Ce(this,void 0,void 0,(function*(){if(this._isVisible){const e=yield this._controller.getGlobalBufferTerm();e&&e!==this._state.searchString&&(this._state.change({searchString:e},!1),this._findInput.select())}}))))),this._findInputFocused=E.bindTo(a),this._findFocusTracker=this._register(ie.go(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus((()=>{this._findInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._findFocusTracker.onDidBlur((()=>{this._findInputFocused.set(!1)}))),this._replaceInputFocused=B.bindTo(a),this._replaceFocusTracker=this._register(ie.go(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus((()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._replaceFocusTracker.onDidBlur((()=>{this._replaceInputFocused.set(!1)}))),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(37).addExtraSpaceOnTop&&(this._viewZone=new $e(0)),this._applyTheme(h.getColorTheme()),this._register(h.onDidColorThemeChange(this._applyTheme.bind(this))),this._register(this._codeEditor.onDidChangeModel((()=>{this._isVisible&&(this._viewZoneId=void 0)}))),this._register(this._codeEditor.onDidScrollChange((e=>{e.scrollTopChanged?this._layoutViewZone():setTimeout((()=>{this._layoutViewZone()}),0)})))}getId(){return Qe.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?this._codeEditor.getOption(83)||this._isReplaceVisible||(this._isReplaceVisible=!0,this._replaceInput.width=ie.w(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){const e=this._state.searchString.length>0&&0===this._state.matchesCount;this._domNode.classList.toggle("no-results",e),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,ge.dL)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){let e;if(this._matchesCount.style.minWidth=Ue+"px",this._state.matchesCount>=ee?this._matchesCount.title=Te:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild),this._state.matchesCount>0){let t=String(this._state.matchesCount);this._state.matchesCount>=ee&&(t+="+");let i=String(this._state.matchesPosition);"0"===i&&(i="?"),e=n.WU(Le,i,t)}else e=He;this._matchesCount.appendChild(document.createTextNode(e)),(0,de.Z9)(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),Ue=Math.max(Ue,this._matchesCount.clientWidth)}_getAriaLabel(e,t,i){if(e===He)return""===i?_e.NC("ariaSearchNoResultEmpty","{0} found",e):_e.NC("ariaSearchNoResult","{0} found for '{1}'",e,i);if(t){const s=_e.NC("ariaSearchNoResultWithLineNum","{0} found for '{1}', at {2}",e,i,t.startLineNumber+":"+t.startColumn),o=this._codeEditor.getModel();if(o&&t.startLineNumber<=o.getLineCount()&&t.startLineNumber>=1){return`${o.getLineContent(t.startLineNumber)}, ${s}`}return s}return _e.NC("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",e,i)}_updateToggleSelectionFindButton(){const e=this._codeEditor.getSelection(),t=!!e&&(e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn),i=this._toggleSelectionFind.checked;this._isVisible&&(i||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);const e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);const i=!this._codeEditor.getOption(83);this._toggleReplaceBtn.setEnabled(this._isVisible&&i)}_reveal(){if(this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(37).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const t=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=t;break}}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout((()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")}),0)),this._revealTimeouts.push(setTimeout((()=>{this._findInput.validate()}),200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(37).seedSearchStringFromSelection&&e){const i=this._codeEditor.getDomNode();if(i){const s=ie.i(i),o=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),n=s.left+(o?o.left:0),r=o?o.top:0;if(this._viewZone&&r<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const i=ie.xQ(this._domNode).left;n>i&&(t=!1);const o=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());s.left+(o?o.left:0)>i&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(37).addExtraSpaceOnTop)return void this._removeViewZone();if(!this._isVisible)return;const t=this._viewZone;void 0===this._viewZoneId&&t&&this._codeEditor.changeViewZones((i=>{t.heightInPx=this._getHeight(),this._viewZoneId=i.addZone(t),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+t.heightInPx)}))}_showViewZone(e=!0){if(!this._isVisible)return;if(!this._codeEditor.getOption(37).addExtraSpaceOnTop)return;void 0===this._viewZone&&(this._viewZone=new $e(0));const t=this._viewZone;this._codeEditor.changeViewZones((i=>{if(void 0!==this._viewZoneId){const s=this._getHeight();if(s===t.heightInPx)return;const o=s-t.heightInPx;return t.heightInPx=s,i.layoutZone(this._viewZoneId),void(e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+o))}{let s=this._getHeight();if(s-=this._codeEditor.getOption(77).top,s<=0)return;t.heightInPx=s,this._viewZoneId=i.addZone(t),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+s)}}))}_removeViewZone(){this._codeEditor.changeViewZones((e=>{void 0!==this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))}))}_applyTheme(e){const t={inputActiveOptionBorder:e.getColor(m.PRb),inputActiveOptionBackground:e.getColor(m.XEs),inputActiveOptionForeground:e.getColor(m.Pvw),inputBackground:e.getColor(m.sEe),inputForeground:e.getColor(m.zJb),inputBorder:e.getColor(m.dt_),inputValidationInfoBackground:e.getColor(m._lC),inputValidationInfoForeground:e.getColor(m.YI3),inputValidationInfoBorder:e.getColor(m.EPQ),inputValidationWarningBackground:e.getColor(m.RV_),inputValidationWarningForeground:e.getColor(m.SUG),inputValidationWarningBorder:e.getColor(m.C3g),inputValidationErrorBackground:e.getColor(m.paE),inputValidationErrorForeground:e.getColor(m._t9),inputValidationErrorBorder:e.getColor(m.OZR)};this._findInput.style(t),this._replaceInput.style(t),this._toggleSelectionFind.style(t)}_tryUpdateWidgetWidth(){if(!this._isVisible)return;if(!ie.Uw(this._domNode))return;const e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0)return void this._domNode.classList.add("hiddenEditor");this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const t=e.width,i=e.minimap.minimapWidth;let s=!1,o=!1,n=!1;if(this._resized){if(ie.w(this._domNode)>qe)return this._domNode.style.maxWidth=t-28-i-15+"px",void(this._replaceInput.width=ie.w(this._findInput.domNode))}if(447+i>=t&&(o=!0),447+i-Ue>=t&&(n=!0),447+i-Ue>=t+50&&(s=!0),this._domNode.classList.toggle("collapsed-find-widget",s),this._domNode.classList.toggle("narrow-find-widget",n),this._domNode.classList.toggle("reduced-find-widget",o),n||s||(this._domNode.style.maxWidth=t-28-i-15+"px"),this._resized){this._findInput.inputBox.layout();const e=this._findInput.inputBox.element.clientWidth;e>0&&(this._replaceInput.width=e)}else this._isReplaceVisible&&(this._replaceInput.width=ie.w(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return(null===this._cachedHeight||this._cachedHeight!==e)&&(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){const e=this._codeEditor.getSelections();e.map((e=>{1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1)));const t=this._state.currentMatch;return e.startLineNumber===e.endLineNumber||l.e.equalsRange(e,t)?null:e})).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){return e.equals(3|Ze)?(this._keybindingService.dispatchEvent(e,e.target)||this._findInput.inputBox.insertAtCursor("\n"),void e.preventDefault()):e.equals(2)?(this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?Ge(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):e.equals(18)?ze(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):void 0}_onReplaceInputKeyDown(e){return e.equals(3|Ze)?(this._keybindingService.dispatchEvent(e,e.target)||(pe.ED&&pe.tY&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(_e.NC("ctrlEnter.keybindingChanged","Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(Ke,!0,0,0)),this._replaceInput.inputBox.insertAtCursor("\n")),void e.preventDefault()):e.equals(2)?(this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(1026)?(this._findInput.focus(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?Ge(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):e.equals(18)?ze(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):void 0}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new me.Yb(null,this._contextViewProvider,{width:221,label:Fe,placeholder:Oe,appendCaseSensitiveLabel:this._keybindingLabelFor($),appendWholeWordsLabel:this._keybindingLabelFor(G),appendRegexLabel:this._keybindingLabelFor(z),validation:e=>{if(0===e.length||!this._findInput.getRegex())return null;try{return new RegExp(e,"gu"),null}catch(e){return{content:e.message}}},flexibleHeight:true,flexibleWidth:true,flexibleMaxHeight:118,showHistoryHint:()=>ve(this._keybindingService)},this._contextKeyService,!0)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown((e=>this._onFindInputKeyDown(e)))),this._register(this._findInput.inputBox.onDidChange((()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)}))),this._register(this._findInput.onDidOptionChange((()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)}))),this._register(this._findInput.onCaseSensitiveKeyDown((e=>{e.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),e.preventDefault())}))),this._register(this._findInput.onRegexKeyDown((e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),e.preventDefault())}))),this._register(this._findInput.inputBox.onDidHeightChange((e=>{this._tryUpdateHeight()&&this._showViewZone()}))),pe.IJ&&this._register(this._findInput.onMouseDown((e=>this._onFindInputMouseDown(e)))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount(),this._prevBtn=this._register(new Ye({label:Ee+this._keybindingLabelFor(H),icon:ye,onTrigger:()=>{this._codeEditor.getAction(H).run().then(void 0,ge.dL)}})),this._nextBtn=this._register(new Ye({label:Be+this._keybindingLabelFor(L),icon:Ie,onTrigger:()=>{this._codeEditor.getAction(L).run().then(void 0,ge.dL)}}));const e=document.createElement("div");e.className="find-part",e.appendChild(this._findInput.domNode);const t=document.createElement("div");t.className="find-actions",e.appendChild(t),t.appendChild(this._matchesCount),t.appendChild(this._prevBtn.domNode),t.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new ce.Z({icon:be,title:ke+this._keybindingLabelFor(Q),isChecked:!1})),this._register(this._toggleSelectionFind.onChange((()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){const e=this._codeEditor.getSelections();e.map((e=>(1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e))).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}else this._state.change({searchScope:null},!0)}))),t.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new Ye({label:Ae+this._keybindingLabelFor(Z),icon:fe.s_,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),e.preventDefault())}})),t.appendChild(this._closeBtn.domNode),this._replaceInput=this._register(new me.Nq(null,void 0,{label:De,placeholder:Me,appendPreserveCaseLabel:this._keybindingLabelFor(Y),history:[],flexibleHeight:true,flexibleWidth:true,flexibleMaxHeight:118,showHistoryHint:()=>ve(this._keybindingService)},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown((e=>this._onReplaceInputKeyDown(e)))),this._register(this._replaceInput.inputBox.onDidChange((()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)}))),this._register(this._replaceInput.inputBox.onDidHeightChange((e=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()}))),this._register(this._replaceInput.onDidOptionChange((()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)}))),this._register(this._replaceInput.onPreserveCaseKeyDown((e=>{e.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),e.preventDefault())}))),this._replaceBtn=this._register(new Ye({label:Ve+this._keybindingLabelFor(j),icon:Ne,onTrigger:()=>{this._controller.replace()},onKeyDown:e=>{e.equals(1026)&&(this._closeBtn.focus(),e.preventDefault())}})),this._replaceAllBtn=this._register(new Ye({label:We+this._keybindingLabelFor(X),icon:Re,onTrigger:()=>{this._controller.replaceAll()}}));const i=document.createElement("div");i.className="replace-part",i.appendChild(this._replaceInput.domNode);const s=document.createElement("div");s.className="replace-actions",i.appendChild(s),s.appendChild(this._replaceBtn.domNode),s.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new Ye({label:Pe,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=ie.w(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.style.width="419px",this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(e),this._domNode.appendChild(i),this._resizeSash=new le.g(this._domNode,this,{orientation:0,size:2}),this._resized=!1;let o=qe;this._register(this._resizeSash.onDidStart((()=>{o=ie.w(this._domNode)}))),this._register(this._resizeSash.onDidChange((e=>{this._resized=!0;const t=o+e.startX-e.currentX;if(t<qe)return;t>(parseFloat(ie.Dx(this._domNode).maxWidth)||0)||(this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=ie.w(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())}))),this._register(this._resizeSash.onDidReset((()=>{const e=ie.w(this._domNode);if(e<qe)return;let t=qe;if(!this._resized||e===qe){const e=this._codeEditor.getLayoutInfo();t=e.width-28-e.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=ie.w(this._findInput.domNode)),this._findInput.inputBox.layout()})))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(2!==e)}}Qe.ID="editor.contrib.findWidget";class Ye extends oe.${constructor(e){super(),this._opts=e;let t="button";this._opts.className&&(t=t+" "+this._opts.className),this._opts.icon&&(t=t+" "+v.kS.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className=t,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this.onclick(this._domNode,(e=>{this._opts.onTrigger(),e.preventDefault()})),this.onkeydown(this._domNode,(e=>{var t,i;if(e.equals(10)||e.equals(3))return this._opts.onTrigger(),void e.preventDefault();null===(i=(t=this._opts).onKeyDown)||void 0===i||i.call(t,e)}))}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...v.kS.asClassNameArray(we)),this._domNode.classList.add(...v.kS.asClassNameArray(xe))):(this._domNode.classList.remove(...v.kS.asClassNameArray(xe)),this._domNode.classList.add(...v.kS.asClassNameArray(we)))}}(0,v.Ic)(((e,t)=>{const i=(e,i)=>{i&&t.addRule(`.monaco-editor ${e} { background-color: ${i}; }`)};i(".findMatch",e.getColor(m.MUv)),i(".currentFindMatch",e.getColor(m.nyM)),i(".findScope",e.getColor(m.jUe));i(".find-widget",e.getColor(m.D0T));const s=e.getColor(m.rh);s&&t.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${s}; }`);const o=e.getColor(m.EiJ);o&&t.addRule(`.monaco-editor .findMatch { border: 1px ${(0,Se.c3)(e.type)?"dotted":"solid"} ${o}; box-sizing: border-box; }`);const n=e.getColor(m.pnM);n&&t.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${n}; padding: 1px; box-sizing: border-box; }`);const r=e.getColor(m.gkn);r&&t.addRule(`.monaco-editor .findScope { border: 1px ${(0,Se.c3)(e.type)?"dashed":"solid"} ${r}; }`);const a=e.getColor(m.lRK);a&&t.addRule(`.monaco-editor .find-widget { border: 1px solid ${a}; }`);const h=e.getColor(m.Hfx);h&&t.addRule(`.monaco-editor .find-widget { color: ${h}; }`);const d=e.getColor(m.Ido);d&&t.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${d}; }`);const c=e.getColor(m.Ng6);if(c)t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${c}; }`);else{const i=e.getColor(m.D1_);i&&t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${i}; }`)}const l=e.getColor(m.lUq);l&&t.addRule(`\n\t\t.monaco-editor .find-widget .button:not(.disabled):hover,\n\t\t.monaco-editor .find-widget .codicon-find-selection:hover {\n\t\t\tbackground-color: ${l} !important;\n\t\t}\n\t`);const u=e.getColor(m.R80);u&&t.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${u}; }`)}));var je=i(4144),Xe=i(4972),Je=i(5606),et=i(1847),tt=i(9422),it=i(6904),st=function(e,t,i,s){var o,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},ot=function(e,t){return function(i,s){t(i,s,e)}},nt=function(e,t,i,s){return new(i||(i=Promise))((function(o,n){function r(e){try{h(s.next(e))}catch(e){n(e)}}function a(e){try{h(s.throw(e))}catch(e){n(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}h((s=s.apply(e,t||[])).next())}))};function rt(e,t="single",i=!1){if(!e.hasModel())return null;const s=e.getSelection();if("single"===t&&s.startLineNumber===s.endLineNumber||"multiple"===t)if(s.isEmpty()){const t=e.getConfiguredWordAtPosition(s.getStartPosition());if(t&&!1===i)return t.word}else if(e.getModel().getValueLengthInRange(s)<524288)return e.getModel().getValueInRange(s);return null}let at=class e extends o.JT{constructor(e,t,i,o){super(),this._editor=e,this._findWidgetVisible=O.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=o,this._updateHistoryDelayer=new s.vp(500),this._state=this._register(new he),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._model=null,this._register(this._editor.onDidChangeModel((()=>{const e=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),e&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(37).loop})})))}get editor(){return this._editor}static get(t){return t.getContribution(e.ID)}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,0),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,0),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,0),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,0)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!E.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){const e=this._editor.getSelections();e.map((e=>(1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._editor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e))).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=n.ec(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}_start(e,t){return nt(this,void 0,void 0,(function*(){if(this.disposeModel(),!this._editor.hasModel())return;const i=Object.assign(Object.assign({},t),{isRevealed:!0});if("single"===e.seedSearchStringFromSelection){const t=rt(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);t&&(this._state.isRegex?i.searchString=n.ec(t):i.searchString=t)}else if("multiple"===e.seedSearchStringFromSelection&&!e.updateSearchScope){const t=rt(this._editor,e.seedSearchStringFromSelection);t&&(i.searchString=t)}if(!i.searchString&&e.seedSearchStringFromGlobalClipboard){const e=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;e&&(i.searchString=e)}if(e.forceRevealReplace||i.isReplaceRevealed?i.isReplaceRevealed=!0:this._findWidgetVisible.get()||(i.isReplaceRevealed=!1),e.updateSearchScope){const e=this._editor.getSelections();e.some((e=>!e.isEmpty()))&&(i.searchScope=e)}i.loop=e.loop,this._state.change(i,!1),this._model||(this._model=new te(this._editor,this._state))}))}start(e,t){return this._start(e,t)}moveToNextMatch(){return!!this._model&&(this._model.moveToNextMatch(),!0)}moveToPrevMatch(){return!!this._model&&(this._model.moveToPrevMatch(),!0)}replace(){return!!this._model&&(this._model.replace(),!0)}replaceAll(){return!!this._model&&(this._model.replaceAll(),!0)}selectAllMatches(){return!!this._model&&(this._model.selectAllMatches(),this._editor.focus(),!0)}getGlobalBufferTerm(){return nt(this,void 0,void 0,(function*(){return this._editor.getOption(37).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}))}setGlobalBufferTerm(e){this._editor.getOption(37).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}};at.ID="editor.contrib.findController",at=st([ot(1,F.i6),ot(2,it.Uy),ot(3,Xe.p)],at);let ht=class extends at{constructor(e,t,i,s,o,n,r,a){super(e,i,r,a),this._contextViewService=t,this._keybindingService=s,this._themeService=o,this._notificationService=n,this._widget=null,this._findOptionsWidget=null}_start(e,t){const i=Object.create(null,{_start:{get:()=>super._start}});return nt(this,void 0,void 0,(function*(){this._widget||this._createFindWidget();const s=this._editor.getSelection();let o=!1;switch(this._editor.getOption(37).autoFindInSelection){case"always":o=!0;break;case"never":o=!1;break;case"multiline":o=!!s&&s.startLineNumber!==s.endLineNumber;break}e.updateSearchScope=e.updateSearchScope||o,yield i._start.call(this,e,t),this._widget&&(2===e.shouldFocus?this._widget.focusReplaceInput():1===e.shouldFocus&&this._widget.focusFindInput())}))}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new Qe(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new ne(this._editor,this._state,this._keybindingService,this._themeService))}};ht=st([ot(1,Je.u),ot(2,F.i6),ot(3,et.d),ot(4,v.XE),ot(5,tt.lT),ot(6,it.Uy),ot(7,Xe.p)],ht);const dt=(0,r.rn)(new r.jY({id:W,label:_e.NC("startFindAction","Find"),alias:"Find",precondition:F.Ao.or(a.u.focus,F.Ao.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:je.eH.MenubarEditMenu,group:"3_find",title:_e.NC({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}}));dt.addImplementation(0,((e,t,i)=>{const s=at.get(t);return!!s&&s.start({forceRevealReplace:!1,seedSearchStringFromSelection:"never"!==t.getOption(37).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(37).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:t.getOption(37).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(37).loop})}));const ct={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},regex:{type:"boolean"},regexOverride:{type:"number",description:_e.NC("actions.find.isRegexOverride",'Overrides "Use Regular Expression" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},wholeWord:{type:"boolean"},wholeWordOverride:{type:"number",description:_e.NC("actions.find.wholeWordOverride",'Overrides "Match Whole Word" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},matchCase:{type:"boolean"},matchCaseOverride:{type:"number",description:_e.NC("actions.find.matchCaseOverride",'Overrides "Math Case" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},preserveCase:{type:"boolean"},preserveCaseOverride:{type:"number",description:_e.NC("actions.find.preserveCaseOverride",'Overrides "Preserve Case" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},findInSelection:{type:"boolean"}}}}]};class lt extends r.R6{constructor(){super({id:T,label:_e.NC("startFindWithArgsAction","Find With Arguments"),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},description:ct})}run(e,t,i){return nt(this,void 0,void 0,(function*(){const e=at.get(t);if(e){const s=i?{searchString:i.searchString,replaceString:i.replaceString,isReplaceRevealed:void 0!==i.replaceString,isRegex:i.isRegex,wholeWord:i.matchWholeWord,matchCase:i.isCaseSensitive,preserveCase:i.preserveCase}:{};yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===e.getState().searchString.length&&"never"!==t.getOption(37).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(37).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:(null==i?void 0:i.findInSelection)||!1,loop:t.getOption(37).loop},s),e.setGlobalBufferTerm(e.getState().searchString)}}))}}class ut extends r.R6{constructor(){super({id:P,label:_e.NC("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(e,t){return nt(this,void 0,void 0,(function*(){const e=at.get(t);e&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(37).loop}),e.setGlobalBufferTerm(e.getState().searchString))}))}}class gt extends r.R6{run(e,t){return nt(this,void 0,void 0,(function*(){const e=at.get(t);e&&!this._run(e)&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===e.getState().searchString.length&&"never"!==t.getOption(37).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(37).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(37).loop}),this._run(e))}))}}class pt extends gt{constructor(){super({id:L,label:_e.NC("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:a.u.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:F.Ao.and(a.u.focus,E),primary:3,weight:100}]})}_run(e){return!!e.moveToNextMatch()&&(e.editor.pushUndoStop(),!0)}}class _t extends gt{constructor(){super({id:H,label:_e.NC("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:a.u.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:F.Ao.and(a.u.focus,E),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}class mt extends r.R6{run(e,t){return nt(this,void 0,void 0,(function*(){const e=at.get(t);if(!e)return;const i="selection"===t.getOption(37).seedSearchStringFromSelection;let s=null;"never"!==t.getOption(37).seedSearchStringFromSelection&&(s=rt(t,"single",i)),s&&e.setSearchString(s),this._run(e)||(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"never"!==t.getOption(37).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:i,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(37).loop}),this._run(e))}))}}class vt extends mt{constructor(){super({id:q,label:_e.NC("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:a.u.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}class ft extends mt{constructor(){super({id:U,label:_e.NC("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:a.u.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}}const St=(0,r.rn)(new r.jY({id:K,label:_e.NC("startReplace","Replace"),alias:"Replace",precondition:F.Ao.or(a.u.focus,F.Ao.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:je.eH.MenubarEditMenu,group:"3_find",title:_e.NC({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}}));St.addImplementation(0,((e,t,i)=>{if(!t.hasModel()||t.getOption(83))return!1;const s=at.get(t);if(!s)return!1;const o=t.getSelection(),n=s.isFindInputFocused(),r=!o.isEmpty()&&o.startLineNumber===o.endLineNumber&&"never"!==t.getOption(37).seedSearchStringFromSelection&&!n,a=n||r?2:1;return s.start({forceRevealReplace:!0,seedSearchStringFromSelection:r?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(37).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:"never"!==t.getOption(37).seedSearchStringFromSelection,shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(37).loop})})),(0,r._K)(at.ID,ht),(0,r.Qr)(lt),(0,r.Qr)(ut),(0,r.Qr)(pt),(0,r.Qr)(_t),(0,r.Qr)(vt),(0,r.Qr)(ft);const Ct=r._l.bindToContribution(at.get);(0,r.fK)(new Ct({id:Z,precondition:O,handler:e=>e.closeFindWidget(),kbOpts:{weight:105,kbExpr:F.Ao.and(a.u.focus,F.Ao.not("isComposing")),primary:9,secondary:[1033]}})),(0,r.fK)(new Ct({id:$,precondition:void 0,handler:e=>e.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:a.u.focus,primary:k.primary,mac:k.mac,win:k.win,linux:k.linux}})),(0,r.fK)(new Ct({id:G,precondition:void 0,handler:e=>e.toggleWholeWords(),kbOpts:{weight:105,kbExpr:a.u.focus,primary:A.primary,mac:A.mac,win:A.win,linux:A.linux}})),(0,r.fK)(new Ct({id:z,precondition:void 0,handler:e=>e.toggleRegex(),kbOpts:{weight:105,kbExpr:a.u.focus,primary:D.primary,mac:D.mac,win:D.win,linux:D.linux}})),(0,r.fK)(new Ct({id:Q,precondition:void 0,handler:e=>e.toggleSearchScope(),kbOpts:{weight:105,kbExpr:a.u.focus,primary:M.primary,mac:M.mac,win:M.win,linux:M.linux}})),(0,r.fK)(new Ct({id:Y,precondition:void 0,handler:e=>e.togglePreserveCase(),kbOpts:{weight:105,kbExpr:a.u.focus,primary:V.primary,mac:V.mac,win:V.win,linux:V.linux}})),(0,r.fK)(new Ct({id:j,precondition:O,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:a.u.focus,primary:3094}})),(0,r.fK)(new Ct({id:j,precondition:O,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:F.Ao.and(a.u.focus,B),primary:3}})),(0,r.fK)(new Ct({id:X,precondition:O,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:a.u.focus,primary:2563}})),(0,r.fK)(new Ct({id:X,precondition:O,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:F.Ao.and(a.u.focus,B),primary:void 0,mac:{primary:2051}}})),(0,r.fK)(new Ct({id:J,precondition:O,handler:e=>e.selectAllMatches(),kbOpts:{weight:105,kbExpr:a.u.focus,primary:515}}))},2980:(e,t,i)=>{i.d(t,{Yb:()=>I,Nq:()=>F,iX:()=>C});var s=i(3070),o=i(5321),n=i(2900),r=i(7927),a=i(3794),h=i(3046),d=i(4669),c=i(3580);const l=c.NC("defaultLabel","input"),u=c.NC("label.preserveCaseToggle","Preserve Case");class g extends n.Z{constructor(e){super({icon:h.lA.preserveCase,title:u+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class p extends a.${constructor(e,t,i,s){super(),this._showOptionButtons=i,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new d.Q5),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new d.Q5),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new d.Q5),this._onInput=this._register(new d.Q5),this._onKeyUp=this._register(new d.Q5),this._onPreserveCaseKeyDown=this._register(new d.Q5),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=t,this.placeholder=s.placeholder||"",this.validation=s.validation,this.label=s.label||l,this.inputActiveOptionBorder=s.inputActiveOptionBorder,this.inputActiveOptionForeground=s.inputActiveOptionForeground,this.inputActiveOptionBackground=s.inputActiveOptionBackground,this.inputBackground=s.inputBackground,this.inputForeground=s.inputForeground,this.inputBorder=s.inputBorder,this.inputValidationInfoBorder=s.inputValidationInfoBorder,this.inputValidationInfoBackground=s.inputValidationInfoBackground,this.inputValidationInfoForeground=s.inputValidationInfoForeground,this.inputValidationWarningBorder=s.inputValidationWarningBorder,this.inputValidationWarningBackground=s.inputValidationWarningBackground,this.inputValidationWarningForeground=s.inputValidationWarningForeground,this.inputValidationErrorBorder=s.inputValidationErrorBorder,this.inputValidationErrorBackground=s.inputValidationErrorBackground,this.inputValidationErrorForeground=s.inputValidationErrorForeground;const n=s.appendPreserveCaseLabel||"",a=s.history||[],h=!!s.flexibleHeight,c=!!s.flexibleWidth,u=s.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new r.p(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder,history:a,showHistoryHint:s.showHistoryHint,flexibleHeight:h,flexibleWidth:c,flexibleMaxHeight:u})),this.preserveCase=this._register(new g({appendTitle:n,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.preserveCase.onChange((e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.preserveCase.onKeyDown((e=>{this._onPreserveCaseKeyDown.fire(e)}))),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;const p=[this.preserveCase.domNode];this.onkeydown(this.domNode,(e=>{if(e.equals(15)||e.equals(17)||e.equals(9)){const t=p.indexOf(document.activeElement);if(t>=0){let i=-1;e.equals(17)?i=(t+1)%p.length:e.equals(15)&&(i=0===t?p.length-1:t-1),e.equals(9)?(p[t].blur(),this.inputBox.focus()):i>=0&&p[i].focus(),o.zB.stop(e,!0)}}}));const _=document.createElement("div");_.className="controls",_.style.display=this._showOptionButtons?"block":"none",_.appendChild(this.preserveCase.domNode),this.domNode.appendChild(_),null==e||e.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,(e=>this._onKeyDown.fire(e))),this.onkeyup(this.inputBox.inputElement,(e=>this._onKeyUp.fire(e))),this.oninput(this.inputBox.inputElement,(e=>this._onInput.fire())),this.onmousedown(this.inputBox.inputElement,(e=>this._onMouseDown.fire(e)))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(e){e?this.enable():this.disable()}style(e){this.inputActiveOptionBorder=e.inputActiveOptionBorder,this.inputActiveOptionForeground=e.inputActiveOptionForeground,this.inputActiveOptionBackground=e.inputActiveOptionBackground,this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){const e={inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground};this.preserveCase.style(e);const t={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder};this.inputBox.style(t)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}validate(){this.inputBox&&this.inputBox.validate()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.inputBox.width=e,this.domNode.style.width=e+"px"}dispose(){super.dispose()}}var _=i(8819),m=i(9989),v=i(9917),f=function(e,t,i,s){var o,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},S=function(e,t){return function(i,s){t(i,s,e)}};const C=new _.uy("suggestWidgetVisible",!1,(0,c.NC)("suggestWidgetVisible","Whether suggestion are visible")),b="historyNavigationWidgetFocus",w="historyNavigationForwardsEnabled",x="historyNavigationBackwardsEnabled";let N;const R=[];function y(e,t){if(R.includes(t))throw new Error("Cannot register the same widget multiple times");R.push(t);const i=new v.SL,s=i.add(e.createScoped(t.element)),o=new _.uy(b,!1).bindTo(s),n=new _.uy(w,!0).bindTo(s),r=new _.uy(x,!0).bindTo(s),a=()=>{o.set(!0),N=t},h=()=>{o.set(!1),N===t&&(N=void 0)};return t.element===document.activeElement&&a(),i.add(t.onDidFocus((()=>a()))),i.add(t.onDidBlur((()=>h()))),i.add((0,v.OF)((()=>{R.splice(R.indexOf(t),1),h()}))),{scopedContextKeyService:s,historyNavigationForwardsEnablement:n,historyNavigationBackwardsEnablement:r,dispose(){i.dispose()}}}let I=class extends s.V{constructor(e,t,i,s,o=!1){super(e,t,o,i),this._register(y(s,this.inputBox))}};I=f([S(3,_.i6)],I);let F=class extends p{constructor(e,t,i,s,o=!1){super(e,t,o,i),this._register(y(s,this.inputBox))}};F=f([S(3,_.i6)],F),m.W.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:_.Ao.and(_.Ao.has(b),_.Ao.equals(x,!0),C.isEqualTo(!1)),primary:16,secondary:[528],handler:e=>{N&&N.showPreviousValue()}}),m.W.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:_.Ao.and(_.Ao.has(b),_.Ao.equals(w,!0),C.isEqualTo(!1)),primary:18,secondary:[530],handler:e=>{N&&N.showNextValue()}})}}]);